{"ast":null,"code":"var _jsxFileName = \"E:\\\\kkustudy\\\\kku3_2\\\\3_2SoftEn\\\\Project-Web-Final67\\\\web\\\\src\\\\pages\\\\Login.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { auth, db } from '../firebaseConfig'; // นำเข้า firebaseConfig\nimport { useNavigate } from 'react-router-dom';\nimport { doc, setDoc } from \"firebase/firestore\"; // Import Firestore functions\nimport { GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword } from 'firebase/auth'; // Import Firebase auth functions\n\n// ฟังก์ชันบันทึกข้อมูลผู้ใช้\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst saveUserData = async () => {\n  const user = auth.currentUser; // รับข้อมูลผู้ใช้จาก Firebase Authentication\n  if (user) {\n    const userRef = doc(db, 'users', user.uid); // ใช้ UID ของผู้ใช้เป็น document ID\n    await setDoc(userRef, {\n      name: user.displayName,\n      // ชื่อผู้ใช้\n      email: user.email,\n      // อีเมลผู้ใช้\n      photo: user.photoURL,\n      // รูปโปรไฟล์\n      classroom: {} // สามารถเพิ่มข้อมูลห้องเรียนที่ผู้ใช้เข้าร่วมในภายหลัง\n    });\n  }\n};\nconst Login = () => {\n  _s();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [isSignup, setIsSignup] = useState(false); // เพิ่มสถานะการเลือกสมัครสมาชิก\n  const navigate = useNavigate();\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      if (user) {\n        saveUserData(); // บันทึกข้อมูลผู้ใช้เมื่อผู้ใช้ลงชื่อเข้าใช้\n        navigate('/home'); // หากผู้ใช้ล็อกอินสำเร็จไปหน้า home\n      }\n    });\n    return () => unsubscribe(); // Cleanup on component unmount\n  }, [navigate]);\n  const handleEmailPasswordLogin = async () => {\n    try {\n      if (isSignup) {\n        // หากเป็นการสมัครสมาชิก\n        await createUserWithEmailAndPassword(auth, email, password);\n        await saveUserData(); // บันทึกข้อมูลผู้ใช้หลังจากสมัครสมาชิกสำเร็จ\n      } else {\n        // หากเป็นการล็อกอิน\n        await signInWithEmailAndPassword(auth, email, password);\n      }\n    } catch (error) {\n      switch (error.code) {\n        case 'auth/email-already-in-use':\n          setError('The email address is already in use by another account.');\n          break;\n        case 'auth/invalid-email':\n          setError('The email address is not valid.');\n          break;\n        case 'auth/operation-not-allowed':\n          setError('Email/password accounts are not enabled.');\n          break;\n        case 'auth/weak-password':\n          setError('The password is too weak. It must be at least 6 characters long.');\n          break;\n        case 'auth/user-disabled':\n          setError('The user account has been disabled by an administrator.');\n          break;\n        case 'auth/user-not-found':\n          setError('There is no user record corresponding to this identifier. The user may have been deleted.');\n          break;\n        case 'auth/wrong-password':\n          setError('The password is invalid or the user does not have a password.');\n          break;\n        default:\n          setError('Login/Signup failed. Please check your email and password.');\n          break;\n      }\n      console.error(\"Error: \", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: async () => {\n        try {\n          const provider = new GoogleAuthProvider();\n          await signInWithPopup(auth, provider);\n          await saveUserData(); // บันทึกข้อมูลผู้ใช้หลังจากล็อกอินด้วย Google สำเร็จ\n        } catch (error) {\n          console.error(\"Login error: \", error);\n        }\n      },\n      children: \"Login with Google\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"email\",\n        placeholder: \"Email\",\n        value: email,\n        onChange: e => setEmail(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        placeholder: \"Password\",\n        value: password,\n        onChange: e => setPassword(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleEmailPasswordLogin,\n        children: isSignup ? \"Sign Up\" : \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        onClick: () => setIsSignup(!isSignup),\n        children: isSignup ? \"Already have an account? Login\" : \"Don't have an account? Sign Up\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"BKZv0k/KyumFy7q2aJ9eUcCXIK0=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["useEffect","useState","auth","db","useNavigate","doc","setDoc","GoogleAuthProvider","signInWithPopup","signInWithEmailAndPassword","createUserWithEmailAndPassword","jsxDEV","_jsxDEV","saveUserData","user","currentUser","userRef","uid","name","displayName","email","photo","photoURL","classroom","Login","_s","setEmail","password","setPassword","error","setError","isSignup","setIsSignup","navigate","unsubscribe","onAuthStateChanged","handleEmailPasswordLogin","code","console","children","onClick","provider","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","value","onChange","e","target","style","color","_c","$RefreshReg$"],"sources":["E:/kkustudy/kku3_2/3_2SoftEn/Project-Web-Final67/web/src/pages/Login.js"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { auth, db } from '../firebaseConfig';  // นำเข้า firebaseConfig\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { doc, setDoc } from \"firebase/firestore\"; // Import Firestore functions\r\nimport { GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword } from 'firebase/auth'; // Import Firebase auth functions\r\n\r\n// ฟังก์ชันบันทึกข้อมูลผู้ใช้\r\nconst saveUserData = async () => {\r\n  const user = auth.currentUser;  // รับข้อมูลผู้ใช้จาก Firebase Authentication\r\n  if (user) {\r\n    const userRef = doc(db, 'users', user.uid); // ใช้ UID ของผู้ใช้เป็น document ID\r\n    await setDoc(userRef, {\r\n      name: user.displayName,   // ชื่อผู้ใช้\r\n      email: user.email,        // อีเมลผู้ใช้\r\n      photo: user.photoURL,     // รูปโปรไฟล์\r\n      classroom: {},            // สามารถเพิ่มข้อมูลห้องเรียนที่ผู้ใช้เข้าร่วมในภายหลัง\r\n    });\r\n  }\r\n};\r\n\r\nconst Login = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [isSignup, setIsSignup] = useState(false); // เพิ่มสถานะการเลือกสมัครสมาชิก\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = auth.onAuthStateChanged((user) => {\r\n      if (user) {\r\n        saveUserData();  // บันทึกข้อมูลผู้ใช้เมื่อผู้ใช้ลงชื่อเข้าใช้\r\n        navigate('/home');  // หากผู้ใช้ล็อกอินสำเร็จไปหน้า home\r\n      }\r\n    });\r\n\r\n    return () => unsubscribe(); // Cleanup on component unmount\r\n  }, [navigate]);\r\n\r\n  const handleEmailPasswordLogin = async () => {\r\n    try {\r\n      if (isSignup) {\r\n        // หากเป็นการสมัครสมาชิก\r\n        await createUserWithEmailAndPassword(auth, email, password);\r\n        await saveUserData(); // บันทึกข้อมูลผู้ใช้หลังจากสมัครสมาชิกสำเร็จ\r\n      } else {\r\n        // หากเป็นการล็อกอิน\r\n        await signInWithEmailAndPassword(auth, email, password);\r\n      }\r\n    } catch (error) {\r\n      switch (error.code) {\r\n        case 'auth/email-already-in-use':\r\n          setError('The email address is already in use by another account.');\r\n          break;\r\n        case 'auth/invalid-email':\r\n          setError('The email address is not valid.');\r\n          break;\r\n        case 'auth/operation-not-allowed':\r\n          setError('Email/password accounts are not enabled.');\r\n          break;\r\n        case 'auth/weak-password':\r\n          setError('The password is too weak. It must be at least 6 characters long.');\r\n          break;\r\n        case 'auth/user-disabled':\r\n          setError('The user account has been disabled by an administrator.');\r\n          break;\r\n        case 'auth/user-not-found':\r\n          setError('There is no user record corresponding to this identifier. The user may have been deleted.');\r\n          break;\r\n        case 'auth/wrong-password':\r\n          setError('The password is invalid or the user does not have a password.');\r\n          break;\r\n        default:\r\n          setError('Login/Signup failed. Please check your email and password.');\r\n          break;\r\n      }\r\n      console.error(\"Error: \", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Login with Google */}\r\n      <button onClick={async () => {\r\n        try {\r\n          const provider = new GoogleAuthProvider();\r\n          await signInWithPopup(auth, provider);\r\n          await saveUserData(); // บันทึกข้อมูลผู้ใช้หลังจากล็อกอินด้วย Google สำเร็จ\r\n        } catch (error) {\r\n          console.error(\"Login error: \", error);\r\n        }\r\n      }}>\r\n        Login with Google\r\n      </button>\r\n\r\n      {/* Login or Signup with Email and Password */}\r\n      <div>\r\n        <input\r\n          type=\"email\"\r\n          placeholder=\"Email\"\r\n          value={email}\r\n          onChange={(e) => setEmail(e.target.value)}\r\n        />\r\n        <input\r\n          type=\"password\"\r\n          placeholder=\"Password\"\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n        />\r\n        <button onClick={handleEmailPasswordLogin}>\r\n          {isSignup ? \"Sign Up\" : \"Login\"}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Display error message */}\r\n      {error && <p style={{ color: 'red' }}>{error}</p>}\r\n\r\n      {/* Toggle between Login and Signup */}\r\n      <div>\r\n        <span onClick={() => setIsSignup(!isSignup)}>\r\n          {isSignup ? \"Already have an account? Login\" : \"Don't have an account? Sign Up\"}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}