{"ast":null,"code":"var _jsxFileName = \"E:\\\\kkustudy\\\\kku3_2\\\\3_2SoftEn\\\\Project-Web-Final67\\\\web\\\\src\\\\pages\\\\Login.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { auth, db } from '../firebaseConfig'; // นำเข้า firebaseConfig\nimport { useNavigate } from 'react-router-dom';\nimport { doc, setDoc } from \"firebase/firestore\"; // Import Firestore functions\nimport { GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword } from 'firebase/auth'; // Import Firebase auth functions\n\n// ฟังก์ชันบันทึกข้อมูลผู้ใช้\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst saveUserData = async () => {\n  const user = auth.currentUser; // รับข้อมูลผู้ใช้จาก Firebase Authentication\n  if (user) {\n    const userRef = doc(db, 'users', user.uid); // ใช้ UID ของผู้ใช้เป็น document ID\n    await setDoc(userRef, {\n      name: user.displayName,\n      // ชื่อผู้ใช้\n      email: user.email,\n      // อีเมลผู้ใช้\n      photo: user.photoURL,\n      // รูปโปรไฟล์\n      classroom: {} // สามารถเพิ่มข้อมูลห้องเรียนที่ผู้ใช้เข้าร่วมในภายหลัง\n    });\n  }\n};\nconst Login = () => {\n  _s();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      if (user) {\n        saveUserData(); // บันทึกข้อมูลผู้ใช้เมื่อผู้ใช้ลงชื่อเข้าใช้\n        navigate('/home'); // หากผู้ใช้ล็อกอินสำเร็จไปหน้า home\n      }\n    });\n    return () => unsubscribe(); // Cleanup on component unmount\n  }, [navigate]);\n  const handleEmailPasswordLogin = async () => {\n    try {\n      await signInWithEmailAndPassword(auth, email, password);\n    } catch (error) {\n      setError('Login failed. Please check your email and password.');\n      console.error(\"Login error: \", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: async () => {\n        try {\n          const provider = new GoogleAuthProvider();\n          await signInWithPopup(auth, provider);\n        } catch (error) {\n          console.error(\"Login error: \", error);\n        }\n      },\n      children: \"Login with Google\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"email\",\n        placeholder: \"Email\",\n        value: email,\n        onChange: e => setEmail(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        placeholder: \"Password\",\n        value: password,\n        onChange: e => setPassword(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleEmailPasswordLogin,\n        children: \"Login with Email/Password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"qWZtirUOP7OU9zOPm/gw+43Yuyc=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["useEffect","useState","auth","db","useNavigate","doc","setDoc","GoogleAuthProvider","signInWithPopup","signInWithEmailAndPassword","jsxDEV","_jsxDEV","saveUserData","user","currentUser","userRef","uid","name","displayName","email","photo","photoURL","classroom","Login","_s","setEmail","password","setPassword","error","setError","navigate","unsubscribe","onAuthStateChanged","handleEmailPasswordLogin","console","children","onClick","provider","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","value","onChange","e","target","style","color","_c","$RefreshReg$"],"sources":["E:/kkustudy/kku3_2/3_2SoftEn/Project-Web-Final67/web/src/pages/Login.js"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { auth, db } from '../firebaseConfig';  // นำเข้า firebaseConfig\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { doc, setDoc } from \"firebase/firestore\"; // Import Firestore functions\r\nimport { GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword } from 'firebase/auth'; // Import Firebase auth functions\r\n\r\n// ฟังก์ชันบันทึกข้อมูลผู้ใช้\r\nconst saveUserData = async () => {\r\n  const user = auth.currentUser;  // รับข้อมูลผู้ใช้จาก Firebase Authentication\r\n  if (user) {\r\n    const userRef = doc(db, 'users', user.uid); // ใช้ UID ของผู้ใช้เป็น document ID\r\n    await setDoc(userRef, {\r\n      name: user.displayName,   // ชื่อผู้ใช้\r\n      email: user.email,        // อีเมลผู้ใช้\r\n      photo: user.photoURL,     // รูปโปรไฟล์\r\n      classroom: {},            // สามารถเพิ่มข้อมูลห้องเรียนที่ผู้ใช้เข้าร่วมในภายหลัง\r\n    });\r\n  }\r\n};\r\n\r\nconst Login = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = auth.onAuthStateChanged((user) => {\r\n      if (user) {\r\n        saveUserData();  // บันทึกข้อมูลผู้ใช้เมื่อผู้ใช้ลงชื่อเข้าใช้\r\n        navigate('/home');  // หากผู้ใช้ล็อกอินสำเร็จไปหน้า home\r\n      }\r\n    });\r\n\r\n    return () => unsubscribe(); // Cleanup on component unmount\r\n  }, [navigate]);\r\n\r\n  const handleEmailPasswordLogin = async () => {\r\n    try {\r\n      await signInWithEmailAndPassword(auth, email, password);\r\n    } catch (error) {\r\n      setError('Login failed. Please check your email and password.');\r\n      console.error(\"Login error: \", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Login with Google */}\r\n      <button onClick={async () => {\r\n        try {\r\n          const provider = new GoogleAuthProvider();\r\n          await signInWithPopup(auth, provider);\r\n        } catch (error) {\r\n          console.error(\"Login error: \", error);\r\n        }\r\n      }}>\r\n        Login with Google\r\n      </button>\r\n\r\n      {/* Login with Email and Password */}\r\n      <div>\r\n        <input\r\n          type=\"email\"\r\n          placeholder=\"Email\"\r\n          value={email}\r\n          onChange={(e) => setEmail(e.target.value)}\r\n        />\r\n        <input\r\n          type=\"password\"\r\n          placeholder=\"Password\"\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n        />\r\n        <button onClick={handleEmailPasswordLogin}>\r\n          Login with Email/Password\r\n        </button>\r\n      </div>\r\n\r\n      {/* Display error message */}\r\n      {error && <p style={{ color: 'red' }}>{error}</p>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}